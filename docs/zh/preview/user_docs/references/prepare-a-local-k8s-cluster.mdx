---
description: 创建一个测试用Kubernetes集群
keywords:
- kbcli
- kubeblocks
- addons
- installation
sidebar_label: 创建一个测试用Kubernetes集群
sidebar_position: 5
title: 创建一个测试用Kubernetes集群
---
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# 创建测试用 Kubernetes 集群

本教程介绍如何使用 Minikube、K3d 和 Kind 创建本地 Kubernetes 测试集群。这些工具能帮助您在本地主机轻松体验 KubeBlocks，为开发、测试和实验提供便捷方案，无需搭建完整生产级集群的复杂度。

## 准备工作

确保本地主机已安装以下工具：
- Docker：所有三种工具都依赖 Docker 来创建容器化的 Kubernetes 集群
- kubectl：用于与集群交互的 Kubernetes 命令行工具。参考 [kubectl 安装指南](https://kubernetes.io/docs/tasks/tools/)

<Tabs>

<TabItem value="Kind" label="Kind" default>

## 使用 Kind 创建 Kubernetes 集群

Kind（Kubernetes IN Docker）在 Docker 容器内运行 Kubernetes 集群，是理想的本地测试工具。

1. 安装 Kind。详情参考 [Kind 快速入门](https://kind.sigs.k8s.io/docs/user/quick-start/)。

   <Tabs>

   <TabItem value="macOS" label="macOS" default>

   ```bash
   brew install kind
   ```

   </TabItem>

   <TabItem value="Linux" label="Linux">

   ```bash
   # 适用于 AMD64 / x86_64
   [ $(uname -m) = x86_64 ] && curl -Lo ./kind https://kind.sigs.k8s.io/dl/v0.24.0/kind-linux-amd64
   # 适用于 ARM64
   [ $(uname -m) = aarch64 ] && curl -Lo ./kind https://kind.sigs.k8s.io/dl/v0.24.0/kind-linux-arm64
   chmod +x ./kind
   sudo cp ./kind /usr/local/bin/kind
   rm -rf kind
   ```

   </TabItem>

   <TabItem value="Windows" label="Windows">

   可使用 chocolatey 安装 Kind。

   ```bash
   choco install kind
   ```

   </TabItem>

   </Tabs>

2. 创建 Kind 集群。

   ```bash
   kind create cluster --name mykindcluster
   ```

   该命令会在 Docker 容器中创建单节点 Kubernetes 集群。

3. 检查集群是否启动运行。

   ```bash
   kubectl get nodes
   >
   NAME                          STATUS   ROLES           AGE   VERSION
   mykindcluster-control-plane   Ready    control-plane   25s   v1.31.0
   ```

   从输出可见名为 `mykindcluster-control-plane` 的节点，表示集群创建成功。

4. （可选）配置多节点集群。

   Kind 支持多节点集群，可通过配置文件创建。

   ```yaml
   kind: Cluster
   apiVersion: kind.x-k8s.io/v1alpha4
   nodes:
     role: control-plane
     role: worker
     role: worker
   ```

   使用配置文件创建多节点集群：

   ```bash
   kind create cluster --name multinode-cluster --config kind-config.yaml
   ```

5. 如需删除 Kind 集群，运行以下命令：

   ```bash
   kind delete cluster --name mykindcluster
   ```

</TabItem>

<TabItem value="Minikube" label="Minikube">

## 使用 Minikube 创建 Kubernetes 集群

Minikube 在本地机器上运行单节点 Kubernetes 集群，支持虚拟机或容器两种方式。

1. 安装 Minikube。详情参考 [Minikube 快速入门](https://minikube.sigs.k8s.io/docs/start/)。

   <Tabs>

   <TabItem value="macOS" label="macOS" default>

   ```bash
   brew install minikube
   ```

   </TabItem>

   <TabItem value="Linux" label="Linux">

   ```bash
   curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-latest.x86_64.rpm
   sudo rpm -Uvh minikube-latest.x86_64.rpm
   ```

   </TabItem>

   <TabItem value="Windows" label="Windows">

   可使用 chocolatey 安装 Minikube。

   ```bash
   choco install minikube
   ```

   </TabItem>

   </Tabs>

2. 启动 Minikube。该命令将创建本地 Kubernetes 集群。

   ```bash
   minikube start
   ```

   也可指定其他驱动（如 Docker、Hyperkit、KVM）启动：

   ```bash
   minikube start --driver=docker
   ```

3. 验证 Minikube 和 K8s 集群是否正常运行。

   检查 Minikube 状态：

   ```bash
   minikube status
   >
   minikube
   type: Control Plane
   host: Running
   kubelet: Running
   apiserver: Running
   kubeconfig: Configured
   ```

   检查 K8s 集群状态：

   ```bash
   kubectl get nodes
   >
   NAME       STATUS   ROLES           AGE    VERSION
   minikube   Ready    control-plane   1d     v1.26.3
   ```

   输出显示 Minikube 节点已就绪。

</TabItem>

<TabItem value="k3d" label="k3d">

## 使用 k3d 创建 Kubernetes 集群

k3d 是轻量级工具，可在 Docker 容器中运行 k3s（轻量级 Kubernetes 发行版）。

1. 安装 k3d。详情参考 [k3d 快速入门](https://k3d.io/v5.7.4/#releases)。

   <Tabs>

   <TabItem value="macOS" label="macOS" default>

   ```bash
   brew install k3d
   ```

   </TabItem>

   <TabItem value="Linux" label="Linux">

   ```bash
   curl -s https://raw.githubusercontent.com/k3d-io/k3d/main/install.sh | bash
   ```

   </TabItem>

   <TabItem value="Windows" label="Windows">

   可使用 chocolatey 安装 k3d。

   ```bash
   choco install k3d
   ```

   </TabItem>

   </Tabs>

2. 创建 k3s 集群。

   ```bash
   k3d cluster create myk3s
   ```

   该命令将创建名为 `myk3s` 的单节点 Kubernetes 集群。

3. 验证集群是否正常运行。

   ```bash
   kubectl get nodes
   >
   NAME                 STATUS   ROLES                  AGE   VERSION
   k3d-myk3s-server-0   Ready    control-plane,master   31s   v1.30.4+k3s1
   ```

4. 如需删除 k3s 集群，运行以下命令：

   ```bash
   k3d cluster delete myk3s
   ```

</TabItem>

</Tabs>